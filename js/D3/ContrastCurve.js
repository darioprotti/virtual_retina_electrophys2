function TuningCurve1(t,s,a){this.visSizes=t,this.xDomain=s,this.maxY=a,ContrastSizesTicks=[3,10,20,30,50,80,100],this.makeContrastTuningCurveGraph=function(t,i,s){s||(s={top:10,right:50,bottom:50,left:60}),this.width=this.visSizes.width-s.left-s.right,this.height=this.visSizes.height-s.top-s.bottom,this.ContrastScale=d3.scale.linear().range([0,this.width]).domain(this.xDomain),this.firingScale=d3.scale.linear().range([this.height,0]).domain([0,a]);var e;e="undefined"!=typeof SpotSizes?d3.svg.axis().scale(this.ContrastScale).orient("bottom").tickValues(ContrastSizesTicks):d3.svg.axis().scale(this.ContrastScale).orient("bottom");var r=d3.svg.axis().scale(this.firingScale).orient("left").ticks(8);this.svg=d3.select(t).append("svg").attr("viewBox","0,0,"+(this.width+s.left+s.right)+","+(this.height+s.top+s.bottom)).attr("preserveAspectRatio","xMidYMid meet").append("g").attr("transform","translate("+s.left+","+s.top+")"),this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(e).append("text").attr("transform","translate("+this.width/2+",40)").attr("text-anchor","middle").text(i),this.svg.append("g").attr("class","y axis").call(r).append("text").attr("transform","translate(-40,"+this.height/2+") rotate(-90)").style("text-anchor","middle").text("Number of spikes"),this.svg.append("g").attr("class","userData2")},this.addTrials=function(t,s,a){var e=[-90,-75,-60,-45,-30,-15,0,15,30,45,60,75,90];for(j=0;j<e.length;j++)for(i=0;i<a;i++)nrSpikesThisTrial2=poisson(s.tuningFunction1(e[j])),thisTrial={x:e[j],y:nrSpikesThisTrial2,color:"hsl(180, 100%, 25%)",legendIx:NaN},this.addTrialToGraph(t,thisTrial)},this.fitTunCurve=function(t,i){var s=[];for(Spot=0;Spot<600;Spot++)s.push({Spot:Spot,rate:i.tuningFunction1(Spot)});x=this.ContrastScale,y=this.firingScale;var a=d3.svg.line().x(function(t){return x(t.Spot)}).y(function(t){return y(t.rate)});d3.select(t+" .userData2").append("path").attr("class","line").attr("d",a(s)).attr("stroke","hsl(180, 100%, 25%)").attr("fill","none").attr("stroke-width","4").attr("shape-rendering","crispEdges")},this.addDashedLine=function(t,i){d3.select(t+" .userData2").append("line").attr("stroke","hsl(180, 100%, 25%)").style("stroke-dasharray","3, 3").attr("stroke-width","2").attr({x1:this.ContrastScale(i.log),y1:this.firingScale(0),x2:this.ContrastScale(i.log),y2:this.firingScale(i.ContrasttuningFunction(i.log))}),d3.select(t+" .userData2").append("line").attr("stroke","hsl(180, 100%, 25%)").style("stroke-dasharray","3, 3").attr("stroke-width","2").attr({x1:this.ContrastScale(i.log),y1:this.firingScale(i.tuningFunction(i.log)),x2:this.ContrastScale(this.xDomain[0]),y2:this.firingScale(i.tuningFunction(i.log))})}}